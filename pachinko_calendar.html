<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ãƒ‘ãƒãƒ³ã‚³ãƒ»ãƒ‘ãƒã‚¹ãƒ­ ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤º</title>
  <style>
    /* å…¨ä½“çš„ãªãƒªã‚»ãƒƒãƒˆ */
    * { margin: 0; padding: 0; box-sizing: border-box; }

    /* bodyã®ã‚¹ã‚¿ã‚¤ãƒ«: ãƒ•ã‚©ãƒ³ãƒˆã€èƒŒæ™¯ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€æœ€å°é«˜ã•ã€ãƒ‘ãƒ‡ã‚£ãƒ³ã‚° */
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒŠã®ã‚¹ã‚¿ã‚¤ãƒ«: æœ€å¤§å¹…ã€ä¸­å¤®å¯„ã›ã€èƒŒæ™¯ã€è§’ä¸¸ã€å½±ã€ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼å‡¦ç† */
    .container {
      max-width: 1000px;
      margin: 0 auto;
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      overflow: hidden;
    }

    /* ãƒ˜ãƒƒãƒ€ãƒ¼ã®ã‚¹ã‚¿ã‚¤ãƒ«: èƒŒæ™¯ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€æ–‡å­—è‰²ã€ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã€ä¸­å¤®å¯„ã› */
    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      text-align: center;
    }

    /* ãƒ˜ãƒƒãƒ€ãƒ¼ã®ã‚¿ã‚¤ãƒˆãƒ« */
    .header h1 { font-size: 28px; margin-bottom: 10px; }

    /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒªãƒ³ã‚¯ã‚³ãƒ³ãƒ†ãƒŠã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .nav-links {
      display: flex;
      gap: 10px;
      justify-content: center;
      flex-wrap: wrap;
      margin-top: 15px;
    }

    /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒªãƒ³ã‚¯å€‹åˆ¥ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .nav-link {
      display: inline-block;
      padding: 10px 20px;
      background: rgba(255,255,255,0.2);
      color: white;
      text-decoration: none;
      border-radius: 8px;
      font-weight: 600;
      transition: all 0.3s;
    }

    /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒªãƒ³ã‚¯ãƒ›ãƒãƒ¼æ™‚ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .nav-link:hover {
      background: rgba(255,255,255,0.3);
      transform: translateY(-2px);
    }

    /* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .content { padding: 30px; }

    /* ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ˜ãƒƒãƒ€ãƒ¼ã®ã‚¹ã‚¿ã‚¤ãƒ« (æœˆè¡¨ç¤ºã€ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³) */
    .calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 15px;
    }

    /* ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ã®ã‚°ãƒ«ãƒ¼ãƒ— */
    .calendar-nav {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    /* ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .nav-btn {
      padding: 10px 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s;
    }

    /* ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ãƒ›ãƒãƒ¼æ™‚ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .nav-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }

    /* ç¾åœ¨ã®æœˆè¡¨ç¤ºãƒ†ã‚­ã‚¹ãƒˆã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .current-month {
      font-size: 24px;
      font-weight: 700;
      color: #667eea;
    }

    /* ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æœ¬ä½“ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .calendar {
      background: white;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    /* ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚°ãƒªãƒƒãƒ‰ã®ã‚¹ã‚¿ã‚¤ãƒ« (æ›œæ—¥ã¨æ—¥ä»˜ã®é…ç½®) */
    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr); /* 7åˆ— */
      gap: 1px;
      background: #e0e0e0; /* ã‚°ãƒªãƒƒãƒ‰ç·šã®è‰² */
    }

    /* æ›œæ—¥ãƒ˜ãƒƒãƒ€ãƒ¼ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .calendar-day-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 15px;
      text-align: center;
      font-weight: 600;
    }

    /* æ—¥ä»˜ã‚»ãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .calendar-day {
      background: white;
      padding: 10px;
      min-height: 120px; /* ã‚ã‚‹ç¨‹åº¦ã®é«˜ã•ã‚’ç¢ºä¿ */
      position: relative;
      cursor: pointer;
      transition: all 0.3s;
      display: flex; /* Flexboxã§å†…å®¹ã‚’ç¸¦ã«é…ç½® */
      flex-direction: column;
    }

    /* æ—¥ä»˜ã‚»ãƒ«ãƒ›ãƒãƒ¼æ™‚ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .calendar-day:hover { background: #f8f9fa; }

    /* ä»–ã®æœˆã®æ—¥ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .calendar-day.other-month {
      background: #f5f5f5;
      color: #999;
    }

    /* ä»Šæ—¥ã®æ—¥ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .calendar-day.today { background: #fff3cd; }

    /* æ—¥ä»˜ç•ªå·ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .day-number {
      font-weight: 600;
      margin-bottom: 5px;
      color: #333;
    }

    /* ãã®æ—¥ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒˆã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .day-events {
      font-size: 12px;
      flex-grow: 1; /* æ®‹ã‚Šã®é«˜ã•ã‚’åŸ‹ã‚ã‚‹ */
      overflow: hidden; /* ã¯ã¿å‡ºã—ãŸå†…å®¹ã‚’éš ã™ */
    }

    /* å„ã‚¤ãƒ™ãƒ³ãƒˆã‚¢ã‚¤ãƒ†ãƒ ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .event-item {
      padding: 3px 6px;
      margin: 2px 0;
      border-radius: 4px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis; /* é•·ã™ãã‚‹ãƒ†ã‚­ã‚¹ãƒˆã‚’çœç•¥ */
    }

    /* ãƒ—ãƒ©ã‚¹åæ”¯ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚¢ã‚¤ãƒ†ãƒ ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .event-positive {
      background: #d4edda;
      color: #155724;
    }

    /* ãƒã‚¤ãƒŠã‚¹åæ”¯ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚¢ã‚¤ãƒ†ãƒ ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .event-negative {
      background: #f8d7da;
      color: #721c24;
    }

    /* æ—¥ä»˜ã”ã¨ã®åˆè¨ˆåæ”¯ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .day-total {
      margin-top: auto; /* æ—¥ä»˜ã‚»ãƒ«ã®ä¸‹éƒ¨ã«é…ç½® */
      padding-top: 5px;
      font-weight: 700;
      font-size: 14px;
      text-align: right;
    }

    /* æœˆé–“ã‚µãƒãƒªãƒ¼ãƒœãƒƒã‚¯ã‚¹ã®ã‚³ãƒ³ãƒ†ãƒŠã‚¹ã‚¿ã‚¤ãƒ« */
    .summary {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãª3åˆ— */
      gap: 15px;
      margin-bottom: 30px;
    }

    /* æœˆé–“ã‚µãƒãƒªãƒ¼å€‹åˆ¥ã®ãƒœãƒƒã‚¯ã‚¹ã‚¹ã‚¿ã‚¤ãƒ« */
    .summary-box {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      border-radius: 15px;
      text-align: center;
    }

    /* ã‚µãƒãƒªãƒ¼ã®å€¤ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .summary-value {
      font-size: 32px;
      font-weight: 700;
      margin: 10px 0;
    }

    /* ã‚µãƒãƒªãƒ¼ã®ãƒ©ãƒ™ãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .summary-label {
      font-size: 14px;
      opacity: 0.9;
    }
    
    /* === ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã§ã®è¡¨ç¤ºèª¿æ•´ (768pxä»¥ä¸‹) === */
    @media (max-width: 768px) {
        body { padding: 10px; }
        .content { padding: 15px; }
        
        /* ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ç¸¦ä¸¦ã³ã«å¤‰æ›´ã—ã€é–“éš”ã‚’èª¿æ•´ */
        .calendar-header {
            flex-direction: column;
            gap: 15px;
            padding: 15px;
        }
        .current-month { font-size: 20px; } /* æœˆè¡¨ç¤ºã®æ–‡å­—ã‚µã‚¤ã‚ºã‚’å°ã•ã */
        .nav-btn {
            padding: 8px 16px;
            font-size: 14px;
        }

        /* ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚°ãƒªãƒƒãƒ‰ã®ã‚»ãƒ«é–“éš”ã‚’ç‹­ã‚ã‚‹ */
        .calendar-grid {
            gap: 0; /* ã‚»ãƒ«é–“ã®éš™é–“ã‚’ãªãã™ã‹ã€éå¸¸ã«å°ã•ãã™ã‚‹ */
        }
        /* å„æ—¥ä»˜ã‚»ãƒ«ã®ã‚µã‚¤ã‚ºã€ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã€ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’èª¿æ•´ */
        .calendar-day {
            min-height: 80px; /* é«˜ã•ã‚’æŠ‘ãˆã‚‹ */
            padding: 5px; /* å†…å´ã®ä½™ç™½ã‚’æ¸›ã‚‰ã™ */
            font-size: 11px; /* å…¨ä½“çš„ãªãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’å°ã•ã */
        }
        /* æ›œæ—¥ãƒ˜ãƒƒãƒ€ãƒ¼ã®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã¨ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚‚èª¿æ•´ */
        .calendar-day-header {
            padding: 10px 5px; 
            font-size: 12px;
        }
        /* æ—¥ä»˜ç•ªå·ã‚’å°ã•ã */
        .day-number {
            font-size: 12px; 
            margin-bottom: 2px;
        }
        /* ã‚¤ãƒ™ãƒ³ãƒˆã‚¢ã‚¤ãƒ†ãƒ ã®ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã€ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã€ãƒãƒ¼ã‚¸ãƒ³ã‚’èª¿æ•´ */
        .event-item {
            padding: 2px 4px;
            font-size: 9px; 
            margin: 1px 0; 
        }
        /* åˆè¨ˆåæ”¯ã®ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã¨ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’èª¿æ•´ */
        .day-total {
            font-size: 10px; 
            padding-top: 2px;
        }
        
        /* ã‚µãƒãƒªãƒ¼ãƒœãƒƒã‚¯ã‚¹ã‚’1åˆ—ã«ã™ã‚‹ */
        .summary {
            grid-template-columns: 1fr; 
        }
        /* ã‚µãƒãƒªãƒ¼ã®å€¤ã‚’å°ã•ã */
        .summary-value {
            font-size: 24px; 
        }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ“… ãƒ‘ãƒãƒ³ã‚³ãƒ»ãƒ‘ãƒã‚¹ãƒ­ ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤º</h1>
      <p>æœˆã”ã¨ã®åæ”¯ã‚’ä¸€è¦§ã§ç¢ºèª</p>
      <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒªãƒ³ã‚¯ -->
      <div class="nav-links">
        <a href="index.html" class="nav-link">ğŸ  å®¶è¨ˆç°¿ãƒ›ãƒ¼ãƒ </a>
        <a href="register.html" class="nav-link">ğŸ“ æ©Ÿç¨®ç™»éŒ²</a>
        <a href="pachinko_index.html" class="nav-link">ğŸ° åæ”¯ç™»éŒ²</a>
        <a href="pachinko_graph.html" class="nav-link">ğŸ“Š ã‚°ãƒ©ãƒ•</a>
        <a href="pachinko_gacha.html" class="nav-link">ğŸ° ã‚¬ãƒãƒ£</a> 
      </div>
    </div>

    <div class="content">
      <!-- æœˆé–“ã‚µãƒãƒªãƒ¼è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
      <div class="summary">
        <div class="summary-box">
          <div class="summary-label">ä»Šæœˆã®ç·æŠ•è³‡é¡</div>
          <div class="summary-value" id="month-investment">Â¥0</div>
        </div>
        <div class="summary-box">
          <div class="summary-label">ä»Šæœˆã®ç·å›åé¡</div>
          <div class="summary-value" id="month-return">Â¥0</div>
        </div>
        <div class="summary-box">
          <div class="summary-label">ä»Šæœˆã®åæ”¯</div>
          <div class="summary-value" id="month-diff">Â¥0</div>
        </div>
      </div>

      <!-- ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ˜ãƒƒãƒ€ãƒ¼ (æœˆç§»å‹•ãƒœã‚¿ãƒ³ã€æœˆè¡¨ç¤ºã€ä»Šæ—¥ãƒœã‚¿ãƒ³) -->
      <div class="calendar-header">
        <div class="calendar-nav">
          <button class="nav-btn" onclick="previousMonth()">â—€ å‰æœˆ</button>
          <div class="current-month" id="current-month"></div>
          <button class="nav-btn" onclick="nextMonth()">æ¬¡æœˆ â–¶</button>
        </div>
        <button class="nav-btn" onclick="goToday()">ä»Šæ—¥</button>
      </div>

      <!-- ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æœ¬ä½“ -->
      <div class="calendar">
        <div class="calendar-grid" id="calendar-grid"></div>
      </div>
    </div>
  </div>

<script>
    // ç¾åœ¨è¡¨ç¤ºã—ã¦ã„ã‚‹å¹´ã¨æœˆ (0-indexed: 0ãŒ1æœˆ)
    let currentYear = new Date().getFullYear();
    let currentMonth = new Date().getMonth();

    /**
     * ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰å±¥æ­´ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹é–¢æ•°
     * @returns {Array<Object>} å±¥æ­´ãƒ‡ãƒ¼ã‚¿ã®é…åˆ—
     */
    function getHistory() {
      return JSON.parse(localStorage.getItem("history") || "[]");
    }

    /**
     * ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹é–¢æ•°
     */
    function renderCalendar() {
      const grid = document.getElementById("calendar-grid");
      grid.innerHTML = ""; // æ—¢å­˜ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼å†…å®¹ã‚’ã‚¯ãƒªã‚¢

      // æ›œæ—¥ãƒ˜ãƒƒãƒ€ãƒ¼ã®ç”Ÿæˆ
      const weekdays = ["æ—¥", "æœˆ", "ç«", "æ°´", "æœ¨", "é‡‘", "åœŸ"];
      weekdays.forEach(day => {
        const header = document.createElement("div");
        header.className = "calendar-day-header";
        header.textContent = day;
        grid.appendChild(header);
      });

      // ç¾åœ¨ã®æœˆã®æƒ…å ±ã‚’å–å¾—
      const firstDay = new Date(currentYear, currentMonth, 1); // ä»Šæœˆã®1æ—¥
      const lastDay = new Date(currentYear, currentMonth + 1, 0); // ä»Šæœˆã®æœ€çµ‚æ—¥
      const prevLastDay = new Date(currentYear, currentMonth, 0); // å…ˆæœˆã®æœ€çµ‚æ—¥
      
      const firstDayOfWeek = firstDay.getDay(); // ä»Šæœˆã®1æ—¥ã®æ›œæ—¥ (0:æ—¥, 1:æœˆ...)
      const daysInMonth = lastDay.getDate(); // ä»Šæœˆã®æ—¥æ•°
      const daysInPrevMonth = prevLastDay.getDate(); // å…ˆæœˆã®æ—¥æ•°

      // ä»Šæ—¥ã®æ—¥ä»˜ã‚’å–å¾— (todayã‚¯ãƒ©ã‚¹ä»˜ä¸ã®ãŸã‚)
      const today = new Date();
      const isCurrentMonth = today.getFullYear() === currentYear && today.getMonth() === currentMonth;
      const todayDate = today.getDate();

      // å±¥æ­´ãƒ‡ãƒ¼ã‚¿ã‚’æ—¥ä»˜ã”ã¨ã«æ•´ç†ã™ã‚‹ãŸã‚ã®ãƒãƒƒãƒ—
      const eventsByDate = {};
      getHistory().forEach(item => {
        const date = item.date;
        if (!eventsByDate[date]) {
          eventsByDate[date] = [];
        }
        eventsByDate[date].push(item);
      });

      // å‰æœˆã®æ—¥ä»˜ã‚»ãƒ«ã‚’ç”Ÿæˆ
      for (let i = firstDayOfWeek - 1; i >= 0; i--) {
        const day = daysInPrevMonth - i;
        const cell = createDayCell(day, true, false); // isOtherMonth=true
        grid.appendChild(cell);
      }

      // å½“æœˆã®æ—¥ä»˜ã‚»ãƒ«ã‚’ç”Ÿæˆ
      for (let day = 1; day <= daysInMonth; day++) {
        const dateStr = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
        const isToday = isCurrentMonth && day === todayDate;
        const events = eventsByDate[dateStr] || [];
        const cell = createDayCell(day, false, isToday, events); // isOtherMonth=false
        grid.appendChild(cell);
      }

      // æ¬¡æœˆã®æ—¥ä»˜ã‚»ãƒ«ã‚’ç”Ÿæˆ (ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚°ãƒªãƒƒãƒ‰ã‚’å¸¸ã«6é€±åˆ†è¡¨ç¤ºã™ã‚‹ãŸã‚)
      const totalCells = firstDayOfWeek + daysInMonth; // å½“æœˆã¨å‰æœˆã®è¡¨ç¤ºæ¸ˆã¿ã‚»ãƒ«æ•°
      const remainingCells = 42 - totalCells; // 6é€± (42æ—¥) ã‹ã‚‰è¡¨ç¤ºæ¸ˆã¿ã‚»ãƒ«ã‚’å¼•ã
      for (let i = 0; i < remainingCells; i++) {
        const day = i + 1; // æ¬¡æœˆã®æ—¥ä»˜ã¯1ã‹ã‚‰é–‹å§‹
        const cell = createDayCell(day, true, false); // isOtherMonth=true
        grid.appendChild(cell);
      }


      // æœˆåè¡¨ç¤ºã‚’æ›´æ–°
      document.getElementById("current-month").textContent = 
        `${currentYear}å¹´ ${currentMonth + 1}æœˆ`;

      // æœˆé–“é›†è¨ˆã‚’æ›´æ–°
      updateMonthlySummary();
    }

    /**
     * æ—¥ä»˜ã‚»ãƒ«ã‚’ä½œæˆã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
     * @param {number} day - æ—¥ä»˜ (ä¾‹: 1, 2, ...)
     * @param {boolean} isOtherMonth - ä»–ã®æœˆã®æ—¥ä»˜ã‹ã©ã†ã‹
     * @param {boolean} isToday - ä»Šæ—¥ã®æ—¥ä»˜ã‹ã©ã†ã‹
     * @param {Array<Object>} events - ãã®æ—¥ã®åæ”¯ã‚¤ãƒ™ãƒ³ãƒˆã®é…åˆ—
     * @returns {HTMLElement} ä½œæˆã•ã‚ŒãŸæ—¥ä»˜ã‚»ãƒ«è¦ç´ 
     */
    function createDayCell(day, isOtherMonth, isToday, events = []) {
      const cell = document.createElement("div");
      cell.className = "calendar-day";
      if (isOtherMonth) cell.classList.add("other-month");
      if (isToday) cell.classList.add("today");

      const dayNumber = document.createElement("div");
      dayNumber.className = "day-number";
      dayNumber.textContent = day;
      cell.appendChild(dayNumber);

      // ä»–ã®æœˆã®æ—¥ã§ãªãã€ã‚¤ãƒ™ãƒ³ãƒˆãŒã‚ã‚‹å ´åˆ
      if (!isOtherMonth && events.length > 0) {
        const eventsDiv = document.createElement("div");
        eventsDiv.className = "day-events";

        let totalDiff = 0;
        let tooltipText = ''; // ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ç”¨ã®è©³ç´°ãƒ†ã‚­ã‚¹ãƒˆ

        events.forEach(event => {
          totalDiff += event.diff;
          const genreIcon = event.genre === 'pachinko' ? 'ğŸ¯' : 'ğŸ°';
          
          // æ©Ÿç¨®åã‚’çœç•¥ã—ã¦è¡¨ç¤º (6æ–‡å­—ã‚ˆã‚Šé•·ã„å ´åˆã¯5æ–‡å­— + "â€¦")
          const machineName = event.machine;
          const displayName = machineName.length > 6 ? machineName.substring(0, 5) + 'â€¦' : machineName;
          
          const eventItem = document.createElement("div");
          eventItem.className = `event-item ${event.diff >= 0 ? 'event-positive' : 'event-negative'}`;
          eventItem.textContent = `${genreIcon} ${displayName}`;
          eventsDiv.appendChild(eventItem);

          // ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã«è¡¨ç¤ºã™ã‚‹è©³ç´°æƒ…å ±ã‚’ä½œæˆ
          const diffText = `${event.diff >= 0 ? '+' : ''}${event.diff.toLocaleString()}å††`;
          tooltipText += `${genreIcon} ${machineName}\n  åæ”¯: ${diffText}\n`;
        });

        // ã‚»ãƒ«ã«titleå±æ€§ã‚’è¨­å®šã—ã¦ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã‚’å®Ÿè£…
        cell.title = tooltipText.trim();

        // æ—¥ã”ã¨ã®åˆè¨ˆåæ”¯ã‚’è¡¨ç¤º
        const totalDiv = document.createElement("div");
        totalDiv.className = "day-total";
        totalDiv.style.color = totalDiff >= 0 ? '#2ecc71' : '#e74c3c'; // ãƒ—ãƒ©ã‚¹ã¯ç·‘ã€ãƒã‚¤ãƒŠã‚¹ã¯èµ¤
        totalDiv.textContent = `${totalDiff >= 0 ? '+' : ''}${totalDiff.toLocaleString()}å††`;
        
        cell.appendChild(eventsDiv); // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒˆã‚’è¿½åŠ 
        cell.appendChild(totalDiv); // åˆè¨ˆåæ”¯ã‚’è¿½åŠ 
      }

      return cell;
    }

    /**
     * æœˆé–“ã‚µãƒãƒªãƒ¼ (ç·æŠ•è³‡ã€ç·å›åã€åæ”¯) ã‚’æ›´æ–°ã™ã‚‹é–¢æ•°
     */
    function updateMonthlySummary() {
      const history = getHistory();
      const monthStart = new Date(currentYear, currentMonth, 1);
      const monthEnd = new Date(currentYear, currentMonth + 1, 1); // ç¿Œæœˆã®1æ—¥ (ã“ã®æ—¥æœªæº€ãŒå½“æœˆ)

      let totalInvestment = 0;
      let totalReturn = 0;

      history.forEach(item => {
        const itemDate = new Date(item.date);
        // å½“æœˆå†…ã®ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚’æŠ½å‡º
        if (itemDate >= monthStart && itemDate < monthEnd) {
          totalInvestment += item.investment;
          totalReturn += item.return;
        }
      });
      
      const totalDiff = totalReturn - totalInvestment;

      // å„è¦ç´ ã«å€¤ã‚’è¨­å®š
      document.getElementById("month-investment").textContent = `Â¥${totalInvestment.toLocaleString()}`;
      document.getElementById("month-return").textContent = `Â¥${totalReturn.toLocaleString()}`;
      
      // åæ”¯ã®è¡¨ç¤ºã¨è‰²ã‚’æ›´æ–°
      const diffElement = document.getElementById("month-diff");
      diffElement.textContent = `Â¥${totalDiff.toLocaleString()}`;
      diffElement.parentElement.style.background = totalDiff >= 0 
        ? 'linear-gradient(135deg, #28a745 0%, #218838 100%)' // ãƒ—ãƒ©ã‚¹ã®å ´åˆã¯ç·‘ç³»
        : 'linear-gradient(135deg, #dc3545 0%, #c82333 100%)'; // ãƒã‚¤ãƒŠã‚¹ã®å ´åˆã¯èµ¤ç³»
    }

    /**
     * å‰æœˆã¸ç§»å‹•ã™ã‚‹é–¢æ•°
     */
    function previousMonth() {
      currentMonth--;
      if (currentMonth < 0) {
        currentMonth = 11; // 12æœˆã«æˆ»ã‚‹
        currentYear--;     // å¹´ã‚’æ¸›ã‚‰ã™
      }
      renderCalendar();
    }

    /**
     * æ¬¡æœˆã¸ç§»å‹•ã™ã‚‹é–¢æ•°
     */
    function nextMonth() {
      currentMonth++;
      if (currentMonth > 11) {
        currentMonth = 0;  // 1æœˆã«é€²ã‚€
        currentYear++;     // å¹´ã‚’å¢—ã‚„ã™
      }
      renderCalendar();
    }

    /**
     * ä»Šæœˆã¸ç§»å‹•ã™ã‚‹é–¢æ•°
     */
    function goToday() {
      const today = new Date();
      currentYear = today.getFullYear();
      currentMonth = today.getMonth();
      renderCalendar();
    }

    // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã«ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’åˆæœŸè¡¨ç¤º
    renderCalendar();
  </script>
</body>
</html>